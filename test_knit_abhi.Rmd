---
title: "How do news headlines develop in the week before Christmas 2021?"
subtitle: "The final project for the intro to data science course at Hertie"
output: 
  html_document:
    toc: FALSE
    df_print: paged
    number_sections: FALSE
    highlight: tango
    theme: "lumen"
    toc_depth: 3
    toc_float: false
    css: custom.css 
    self_contained: false
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r message = FALSE, warning = FALSE, include = FALSE}
## R Markdown

library(tidyverse)
library(fs)
library(tidytext)
library(fs)
library(plotly)
```

```{r message = FALSE, warning = FALSE, include = FALSE}
# importing csv files -----------------------------------------------------
file_paths <- fs::dir_ls("data")
file_paths

file_contents <- list()

for (i in seq_along(file_paths)) {
  file_contents[[i]] <- read_csv(
    file = file_paths[[i]]
  )
}

file_contents <- set_names(file_contents, file_paths)

headlines <- do.call(rbind, file_contents)
```

```{r message = FALSE, warning = FALSE, include = FALSE}
# cleaning with function - before tokenizing! --------------------------------------------------

clean_data <- function(x) { # x = path
  df <- x
  df$time <- as.POSIXct(df$time) %>% as.character() %>% str_replace_all("[ :]", "-")
  df <- select(df, -"...1")
  df$value <- gsub("<.*?>", "", df$value) # remove html tages
  df$value <- gsub(' +',' ', df$value) # remove more than one space
  df$value <- str_trim(df$value, side = c("both", "left", "right")) # remove spaces at start and end
  df[df == ""] <- NA #adding NAs to blank cells
  df <- na.omit(df) # remove NAs
  df <- rename(df, headline = value)
}

headlines <- clean_data(headlines)
```

```{r message = FALSE, warning = FALSE, include = FALSE}
headlines <- headlines %>% # maximum of 5500 headlines to avoid distortion, escecially of uk newspaper dailymail
  mutate(country = dplyr::case_when(name == "guardian" ~ "UK",
                                    name == "times" ~ "UK",
                                    name == "dailymail" ~ "UK",
                                    name == "independent" ~ "UK",
                                    name == "mirror" ~ "UK",
                                    name == "telegraph" ~ "UK",
                                    name == "nytimes" ~ "US",
                                    name == "wsj" ~ "US",
                                    name == "usatoday" ~ "US",
                                    name == "washingtonpost" ~ "US",
                                    name == "latimes" ~ "US",
                                    name == "tampabay" ~ "US",
                                    name == "heraldsun" ~ "Australia",
                                    name == "dailytelegraph" ~ "Australia",
                                    name == "financialreview" ~ "Australia",
                                    name == "couriermail" ~ "Australia",
                                    name == "westaustralian" ~ "Australia",
                                    name == "advertiser" ~ "Australia",
                                    name == "globeandmail" ~ "Canada",
                                    name == "thestar" ~ "Canada",
                                    name == "nationalpost" ~ "Canada",
                                    name == "torontosun" ~ "Canada",
                                    name == "vancouversun" ~ "Canada",
                                    name == "montrealgazette" ~ "Canada",
                                    name == "nzherald" ~ "New-Zealand",
                                    name == "waikato" ~ "New-Zealand",
                                    name == "businessreview" ~ "New-Zealand",
                                    name == "gisborneherald" ~ "New-Zealand",
                                    name == "dominionpost" ~ "New-Zealand",
                                    name == "thepress" ~ "New-Zealand"),
         
          format = dplyr::case_when(name == "dailymail" ~ "tabloid",
                                    name == "mirror" ~ "tabloid",
                                    name == "couriermail" ~ "tabloid",
                                    name == "westaustralian" ~ "tabloid",
                                    name == "advertiser" ~ "tabloid",
                                    name == "torontosun" ~ "tabloid",
                                    name == "nzherald" ~ "tabloid",
                                    TRUE ~ "broadsheet"),
         
         day = dplyr::case_when(grepl("2021-12-09", time) ~ "December 9",
                                grepl("2021-12-10", time) ~ "December 10",
                                grepl("2021-12-11", time) ~ "December 11",
                                grepl("2021-12-12", time) ~ "December 12",
                                grepl("2021-12-13", time) ~ "December 13",
                                grepl("2021-12-14", time) ~ "December 14",
                                grepl("2021-12-15", time) ~ "December 15",
                                grepl("2021-12-16", time) ~ "December 16"))





# ensuring balance --------------------------------------------------------

headlines <- headlines %>% 
  group_by(name) %>% 
  slice(1:5000) %>% 
  ungroup()

                                               
# tokenizing --------------------------------------------------------------

headlines_tok <- headlines %>% 
  unnest_tokens(output = word, input = headline) %>% 
  anti_join(stop_words) 


# clean -------------------------------------------------------------------

headlines_tok <- headlines_tok %>% 
  filter(!grepl('content|subscriber|read|star|10|9|6|min|l.a|wa|nz|canada|uk|west|tampa|times', word))  # dailymail uses the word star everywhore






```

```{r message = FALSE, warning = FALSE, include = FALSE}
# ensuring balance --------------------------------------------------------

Number <-1



headlines_tok["Number"] <- Number



Alldays<-headlines_tok %>%
        group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 




Alldays$word <- factor(Alldays$word, levels = Alldays$word[order(Alldays$occurrences)])

 Alldays <- Alldays %>% ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words across the world ")) + 
     geom_blank()





## December 9 all countries ##


December9_All<- headlines_tok %>%
filter(day == "December 9") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 

December9_All$word <- factor(December9_All$word, levels = December9_All$word[order(December9_All$occurrences)])

    December9_All<-December9_All %>%  ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
    
   
  

 December9_UK <- headlines_tok %>%
filter(day == "December 9"&
country == "UK") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 
 
 December9_UK$word <- factor(December9_UK$word, levels = December9_UK$word[order(December9_UK$occurrences)])
 
 
 December9_UK <- December9_UK %>%  ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +                                  
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 

 
 
 December9_Us <- headlines_tok %>%
filter(day == "December 9"&
country == "US") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 
 
 
 December9_Us$word <- factor(December9_Us$word, levels = December9_Us$word[order(December9_Us$occurrences)])
 
 
 December9_Us <- December9_Us %>%  ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 
 December9_Canada <-headlines_tok %>%
filter(day == "December 9"&
country == "Canada") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 
 
 December9_Canada$word <- factor(December9_Canada$word, levels = December9_Canada$word[order(December9_Canada$occurrences)])
 
 
 December9_Canada <- December9_Canada %>% ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 December9_NZ <-headlines_tok %>%
filter(day == "December 9"&
country == "New-Zealand") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup()
 
 December9_NZ$word <- factor(December9_NZ$word, levels = December9_NZ$word[order(December9_NZ$occurrences)])
 
 
 December9_NZ <- December9_NZ %>% ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 
 December9_Aus <-headlines_tok %>%
filter(day == "December 9"&
country == "Australia") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 
 
 December9_Aus$word <- factor(December9_Aus$word, levels = December9_Aus$word[order(December9_Aus$occurrences)])
 
 
 December9_Aus <- December9_Aus %>% ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()

 
 ## December 10 all countries ##
 
 
 December10_All<- headlines_tok %>%
filter(day == "December 10") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup()
 
 December10_All$word <- factor(December10_All$word, levels = December10_All$word[order(December10_All$occurrences)])
 
 December10_All <-  December10_All %>%  ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
December10_UK<-headlines_tok %>%
filter(day == "December 10"&
country == "UK") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup()  
 
December10_UK$word <- factor(December10_UK$word, levels = December10_UK$word[order(December10_UK$occurrences)])
 
 December10_UK <-  December10_UK %>%
ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 
December10_US <- headlines_tok %>%
filter(day == "December 10"&
country == "US") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 

December10_US$word <- factor(December10_US$word, levels = December10_US$word[order(December10_US$occurrences)])

December10_US <- December10_US %>% 
    ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 
 December10_Canada <-headlines_tok %>%
filter(day == "December 10"&
country == "Canada") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup()
 
 December10_Canada$word <- factor(December10_Canada$word, levels = December10_Canada$word[order(December10_Canada$occurrences)])

 
  December10_Canada <- December10_Canada %>%   ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
December10_NZ <- headlines_tok %>%
filter(day == "December 10"&
country == "New-Zealand") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 

December10_NZ$word <- factor(December10_NZ$word, levels = December10_NZ$word[order(December10_NZ$occurrences)])


 December10_NZ <- December10_NZ %>%    ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 
 December10_Aus <- headlines_tok %>%
filter(day == "December 10"&
country == "Australia") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 
 
 
 December10_Aus$word <- factor(December10_Aus$word, levels = December10_Aus$word[order(December10_Aus$occurrences)])
 
 
 December10_Aus <-December10_Aus %>%   ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 ## December 11 all countries ##
 
 
 
 December11_All<- headlines_tok %>%
filter(day == "December 11") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 
 
 December11_All$word <- factor(December11_All$word, levels = December11_All$word[order(December11_All$occurrences)])
 
   December11_All <-  December11_All %>%  ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
   
 
 December11_UK<-headlines_tok %>%
filter(day == "December 11"&
country == "UK") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup()
 
 December11_UK$word <- factor(December11_UK$word, levels = December11_UK$word[order(December11_UK$occurrences)])
 
 December11_UK <- December11_UK %>%   ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 
 
 
 December11_US<- headlines_tok %>%
filter(day == "December 11"&
country == "US") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 

 December11_US$word <- factor(December11_US$word, levels = December11_US$word[order(December11_US$occurrences)]) 
 
 
December11_US <-  December11_US %>%   ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 
 December11_Canada <-headlines_tok %>%
filter(day == "December 11"&
country == "Canada") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 
 
 December11_Canada$word <- factor(December11_Canada$word, levels = December11_Canada$word[order(December11_Canada$occurrences)]) 
 
 December11_Canada <-December11_Canada %>%  ggplot(aes(x=word, y=occurrences)) +
    geom_col() + xlab("word")+
    
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 December11_NZ <-headlines_tok %>%
filter(day == "December 11"&
country == "New-Zealand") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 
 
 
 December11_NZ$word <- factor(December11_NZ$word, levels = December11_NZ$word[order(December11_NZ$occurrences)]) 
 
  December11_NZ <-December11_NZ %>%   ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 
 December11_Aus <-headlines_tok %>%
filter(day == "December 11"&
country == "Australia") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 
 
 
 December11_Aus$word <- factor(December11_Aus$word, levels = December11_Aus$word[order(December11_Aus$occurrences)]) 
 
 
 
   December11_Aus <- December11_Aus %>% ggplot(aes(x= word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 ## December 12 all countries ##
 
 
 December12_All<- headlines_tok %>%
filter(day == "December 12") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 
 
 December12_All$word <- factor(December12_All$word, levels = December12_All$word[order(December12_All$occurrences)])
 
 
 
December12_All <-December12_All %>% ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 December12_UK <- headlines_tok %>%
filter(day == "December 12"&
country == "UK") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 
 
 December12_UK$word <- factor(December12_UK$word, levels = December12_UK$word[order(December12_UK$occurrences)])
 
 
 
December12_UK <-December12_UK %>% 
 
    ggplot(aes(x=word,
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 
 
 
 December12_US <-headlines_tok %>%
filter(day == "December 12"&
country == "US") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 
 
 December12_US$word <- factor(December12_US$word, levels = December12_US$word[order(December12_US$occurrences)])
 
 
 
December12_US <-December12_US %>% 
    ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 
 December12_Canada <-headlines_tok %>%
filter(day == "December 12"&
country == "Canada") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup()
 
 December12_Canada$word <- factor(December12_Canada$word, levels = December12_Canada$word[order(December12_Canada$occurrences)])
 
 
 
December12_Canada <-December12_Canada %>%
    ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()



 
 December12_NZ <-headlines_tok %>%
filter(day == "December 12"&
country == "New-Zealand") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 
 
 December12_NZ$word <- factor(December12_NZ$word, levels = December12_NZ$word[order(December12_NZ$occurrences)])
 
 
  December12_NZ <-December12_NZ %>%  ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 
 December12_Aus <-headlines_tok %>%
filter(day == "December 12"&
country == "Australia") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 
 
 
 December12_Aus$word <- factor(December12_Aus$word, levels = December12_Aus$word[order(December12_Aus$occurrences)])
 
 
 December12_Aus <-December12_Aus %>% 
   ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 ## December 13 ##
 
 December13_All<- headlines_tok %>%
filter(day == "December 13") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup()
 
 
 
 December13_All$word <- factor(December13_All$word, levels = December13_All$word[order(December13_All$occurrences)])
 
    December13_All <-December13_All %>%ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 
 
December13_UK <-headlines_tok %>%
filter(day == "December 13"&
country == "UK") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 


    December13_UK$word <- factor(December13_UK$word, levels = December13_UK$word[order(December13_UK$occurrences)])
 
    December13_UK <-December13_UK %>%ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 
 
 
 December13_US <-headlines_tok %>%
filter(day == "December 13"&
country == "US") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup()
 
 
     December13_US$word <- factor(December13_US$word, levels = December13_US$word[order(December13_US$occurrences)])
 
    December13_US <-December13_US %>%ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 
    
    
    
  
 December13_Canada <-headlines_tok %>%
filter(day == "December 13"&
country == "Canada") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 
 
 December13_Canada$word <- factor(December13_Canada$word, levels = December13_Canada$word[order(December13_Canada$occurrences)])
 
    December13_Canada <-December13_Canada %>%ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
    
    
  
    
 
 December13_NZ <-headlines_tok %>%
filter(day == "December 13"&
country == "New-Zealand") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup()
 
 
 
    December13_NZ$word <- factor(December13_NZ$word, levels = December13_NZ$word[order(December13_NZ$occurrences)])
 
    December13_NZ <-December13_NZ %>%ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
    
 
 December13_Aus <-headlines_tok %>%
filter(day == "December 13"&
country == "Australia") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 
 
 December13_Aus$word <- factor(December13_Aus$word, levels = December13_Aus$word[order(December13_Aus$occurrences)])
 
    December13_Aus <-December13_Aus %>%ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 
 ## December 14##
 
 December14_All<- headlines_tok %>%
filter(day == "December 14") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 
 
 
 December14_All$word <- factor(December14_All$word, levels = December14_All$word[order(December14_All$occurrences)])
 
    December14_All <-December14_All %>%ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
    
    
 
 December14_UK <-headlines_tok %>%
filter(day == "December 14"&
country == "UK") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 
 
 
    December14_UK$word <- factor(December14_UK$word, levels = December14_UK$word[order(December14_UK$occurrences)])
 
    December14_UK <-December14_UK %>%ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 
 
 
 December14_US <-headlines_tok %>%
filter(day == "December 14"&
country == "US") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup()
 
  
 
 
   December14_US$word <- factor(December14_US$word, levels = December14_US$word[order(December14_US$occurrences)])
 
    December14_US <-December14_US %>%ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
    
    
 
 
 December14_Canada <-headlines_tok %>%
filter(day == "December 14"&
country == "Canada") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 
 
 
    December14_Canada$word <- factor(December14_Canada$word, levels = December14_Canada$word[order(December14_Canada$occurrences)])
 
    December14_Canada <-December14_Canada %>%ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
    
    
    
 December14_NZ <-headlines_tok %>%
filter(day == "December 14"&
country == "New-Zealand") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 
 
 
December14_NZ$word <- factor(December14_NZ$word, levels = December14_NZ$word[order(December14_NZ$occurrences)])
 
    December14_NZ <-December14_NZ %>%ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 
 December14_Aus <-headlines_tok %>%
filter(day == "December 14"&
country == "Australia") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 
 
 
 
   December14_Aus$word <- factor(December14_Aus$word, levels = December14_Aus$word[order(December14_Aus$occurrences)])
 
    December14_Aus <-December14_Aus %>%ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 
 ## December 15
 
 December15_All<- headlines_tok %>%
filter(day == "December 15") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 
 
 
 
    December15_All$word <- factor(December15_All$word, levels = December15_All$word[order(December15_All$occurrences)])
 
    December15_All <-December15_All %>%ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 
 
 
December15_UK <- headlines_tok %>%
filter(day == "December 15"&
country == "UK") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 



   December15_UK$word <- factor(December15_UK$word, levels = December15_UK$word[order(December15_UK$occurrences)])
 
    December15_UK <-December15_UK %>%ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 
 
 
 December15_US <-headlines_tok %>%
filter(day == "December 15"&
country == "US") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup()
 
 
    December15_US$word <- factor(December15_US$word, levels = December15_US$word[order(December15_US$occurrences)])
 
    December15_US <-December15_US %>%ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 
 December15_Canada <-headlines_tok %>%
filter(day == "December 15"&
country == "Canada") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 
 
 
    December15_Canada$word <- factor(December15_Canada$word, levels = December15_Canada$word[order(December15_Canada$occurrences)])
 
    December15_Canada <-December15_Canada %>%ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 December15_NZ <- headlines_tok %>%
filter(day == "December 15"&
country == "New-Zealand") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 
 
 
    December15_NZ$word <- factor(December15_NZ$word, levels = December15_NZ$word[order(December15_NZ$occurrences)])
 
    December15_NZ <-December15_NZ %>%ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 
 December15_Aus <- headlines_tok %>%
filter(day == "December 15"&
country == "Australia") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 
 
 
   December15_Aus$word <- factor(December15_Aus$word, levels = December15_Aus$word[order(December15_Aus$occurrences)])
 
    December15_Aus <-December15_Aus %>%ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 ## December 16
 
 
 December16_All<- headlines_tok %>%
filter(day == "December 16") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 
 
 December16_All$word <- factor(December16_All$word, levels = December16_All$word[order(December16_All$occurrences)])
 
    December16_All <-December16_All %>%ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 
 December16_UK<- headlines_tok %>%
filter(day == "December 16"&
country == "UK") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 
 
 
 December16_UK$word <- factor(December16_UK$word, levels = December16_UK$word[order(December16_UK$occurrences)])
 
    December16_UK <-December16_UK %>%ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 
 
 December16_US<- headlines_tok %>%
filter(day == "December 16"&
country == "US") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 
 
 December16_US$word <- factor(December16_US$word, levels = December16_US$word[order(December16_US$occurrences)])
 
    December16_US <-December16_US %>%ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 
    
    
 December16_Canada <- headlines_tok %>%
filter(day == "December 16"&
country == "Canada") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup() 
 
 
    December16_Canada$word <- factor(December16_Canada$word, levels = December16_Canada$word[order(December16_Canada$occurrences)])
 
    December16_Canada <-December16_Canada %>%ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 December16_NZ <-headlines_tok %>%
filter(day == "December 16"&
country == "New-Zealand") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup()
 
 
    December16_NZ$word <- factor(December16_NZ$word, levels = December16_NZ$word[order(December16_NZ$occurrences)])
 
    December16_NZ <-December16_NZ %>%ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() + xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()
 
 
 December16_Aus<-headlines_tok %>%
filter(day == "December 16"&
country == "Australia") %>%
group_by(word) %>% 
       summarise(occurrences=sum(Number)) %>% 
     arrange(desc(occurrences)) %>% 
      top_n(20) %>%
      ungroup()
 
 
   December16_Aus$word <- factor(December16_Aus$word, levels = December16_Aus$word[order(December16_Aus$occurrences)])
 
    December16_Aus <-December16_Aus %>%ggplot(aes(x=word, 
               y=occurrences)) +
    geom_col() +
  xlab("word")+
    ylab("count") +
    coord_flip() +
     theme_minimal() +
   scale_fill_gradient(high = "#f6a97a", low="#ca3c97") +
     ggtitle(paste("Top", 20 , "frequently used words")) + 
     geom_blank()


                                               


```


## title {.tabset .tabset-fade .tabset-pills}
The headlines used in the main newspapers of the US, UK, Canada, Australia and New-Zealand between December 9 (0.00 CET) and December 16 (0.00 CET)

### Days {.tabset .tabset-fade .tabset-pills}

```{r, out.width='100%'}
ggplotly(Alldays) %>% 
  partial_bundle()
```

It is evident that in all countries, the large majority of headlines relate to *Covid-19* and *Christmas*. In all countries, the usage of words related to these topics fluctuated heavily. This is due to the fact that new developments constantly arise with regards to these topics, such as: what will be the effect of the omicron variant and will we be able to visit our families during Christmas?

### December 9 {.tabset .tabset-fade .tabset-pills}

#### All newspapers

```{r, out.width='100%'}
ggplotly(December9_All) %>% 
  partial_bundle()
```

#### US

```{r, out.width='100%'}

ggplotly(December9_Us) %>% 
  partial_bundle()

```

#### UK

```{r, out.width='100%'}

ggplotly(December9_UK) %>% 
  partial_bundle()

```

#### CANADA

```{r, out.width='100%'}

ggplotly(December9_Canada) %>% 
  partial_bundle()

```

#### AUSTRALIA

```{r, out.width='100%'}

ggplotly(December9_Aus) %>% 
  partial_bundle()

```


#### NEW ZEALAND

```{r, out.width='100%'}

ggplotly(December9_NZ) %>% 
  partial_bundle()

```


### December 10 {.tabset .tabset-fade .tabset-pills}

#### All newspapers

```{r, out.width='100%'}
ggplotly(December10_All) %>% 
  partial_bundle()
```

#### US

```{r, out.width='100%'}

ggplotly(December10_US) %>% 
  partial_bundle()

```

#### UK

```{r, out.width='100%'}

ggplotly(December10_UK) %>% 
  partial_bundle()

```

#### CANADA

```{r, out.width='100%'}

ggplotly(December10_Canada) %>% 
  partial_bundle()

```

#### AUSTRALIA

```{r, out.width='100%'}

ggplotly(December10_Aus) %>% 
  partial_bundle()

```


#### NEW ZEALAND

```{r, out.width='100%'}

ggplotly(December10_NZ) %>% 
  partial_bundle()

```

### December 11 {.tabset .tabset-fade .tabset-pills}

#### All newspapers

```{r, out.width='100%'}
ggplotly(December11_All) %>% 
  partial_bundle()
```

#### US

```{r, out.width='100%'}

ggplotly(December11_US) %>% 
  partial_bundle()

```

#### UK

```{r, out.width='100%'}

ggplotly(December11_UK) %>% 
  partial_bundle()

```

#### CANADA

```{r, out.width='100%'}

ggplotly(December11_Canada) %>% 
  partial_bundle()

```

#### AUSTRALIA

```{r, out.width='100%'}

ggplotly(December11_Aus) %>% 
  partial_bundle()

```


#### NEW ZEALAND

```{r, out.width='100%'}

ggplotly(December11_NZ) %>% 
  partial_bundle()

```


### December 12 {.tabset .tabset-fade .tabset-pills}

#### All newspapers

```{r, out.width='100%'}
ggplotly(December12_All) %>% 
  partial_bundle()
```

#### US

```{r, out.width='100%'}

ggplotly(December12_US) %>% 
  partial_bundle()

```

#### UK

```{r, out.width='100%'}

ggplotly(December12_UK) %>% 
  partial_bundle()

```

#### CANADA

```{r, out.width='100%'}

ggplotly(December12_Canada) %>% 
  partial_bundle()

```

#### AUSTRALIA

```{r, out.width='100%'}

ggplotly(December12_Aus) %>% 
  partial_bundle()

```


#### NEW ZEALAND

```{r, out.width='100%'}

ggplotly(December12_NZ) %>% 
  partial_bundle()

```

### December 13 {.tabset .tabset-fade .tabset-pills}

#### All newspapers

```{r, out.width='100%'}
ggplotly(December13_All) %>% 
  partial_bundle()
```

#### US

```{r, out.width='100%'}

ggplotly(December13_US) %>% 
  partial_bundle()

```

#### UK

```{r, out.width='100%'}

ggplotly(December13_UK) %>% 
  partial_bundle()

```

#### CANADA

```{r, out.width='100%'}

ggplotly(December13_Canada) %>% 
  partial_bundle()

```

#### AUSTRALIA

```{r, out.width='100%'}

ggplotly(December13_Aus) %>% 
  partial_bundle()

```


#### NEW ZEALAND

```{r, out.width='100%'}

ggplotly(December13_NZ) %>% 
  partial_bundle()

```

### December 14 {.tabset .tabset-fade .tabset-pills}

#### All newspapers

```{r, out.width='100%'}
ggplotly(December14_All) %>% 
  partial_bundle()
```

#### US

```{r, out.width='100%'}

ggplotly(December14_US) %>% 
  partial_bundle()

```

#### UK

```{r, out.width='100%'}

ggplotly(December14_UK) %>% 
  partial_bundle()

```

#### CANADA

```{r, out.width='100%'}

ggplotly(December14_Canada) %>% 
  partial_bundle()

```

#### AUSTRALIA

```{r, out.width='100%'}

ggplotly(December14_Aus) %>% 
  partial_bundle()

```


#### NEW ZEALAND

```{r, out.width='100%'}

ggplotly(December14_NZ) %>% 
  partial_bundle()

```

### December 15 {.tabset .tabset-fade .tabset-pills}

#### All newspapers

```{r, out.width='100%'}
ggplotly(December15_All) %>% 
  partial_bundle()
```

#### US

```{r, out.width='100%'}

ggplotly(December15_US) %>% 
  partial_bundle()

```

#### UK

```{r, out.width='100%'}

ggplotly(December15_UK) %>% 
  partial_bundle()

```

#### CANADA

```{r, out.width='100%'}

ggplotly(December15_Canada) %>% 
  partial_bundle()

```

#### AUSTRALIA

```{r, out.width='100%'}

ggplotly(December15_Aus) %>% 
  partial_bundle()

```


#### NEW ZEALAND

```{r, out.width='100%'}

ggplotly(December15_NZ) %>% 
  partial_bundle()

```




### December 16 {.tabset .tabset-fade .tabset-pills}

#### All newspapers

```{r, out.width='100%'}
ggplotly(December16_All) %>% 
  partial_bundle()
```

#### US

```{r, out.width='100%'}

ggplotly(December16_US) %>% 
  partial_bundle()

```

#### UK

```{r, out.width='100%'}

ggplotly(December16_UK) %>% 
  partial_bundle()

```

#### CANADA

```{r, out.width='100%'}

ggplotly(December16_Canada) %>% 
  partial_bundle()

```

#### AUSTRALIA

```{r, out.width='100%'}

ggplotly(December16_Aus) %>% 
  partial_bundle()

```


#### NEW ZEALAND

```{r, out.width='100%'}

ggplotly(December16_NZ) %>% 
  partial_bundle()

```
